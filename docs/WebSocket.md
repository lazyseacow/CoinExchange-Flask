# WebSocket 行情推送
- ## 请求方式 
```
websocket ws://192.168.1.10:8888
```
- ## 请求参数
```
{
    "action": "true",
    "params": [
        "btcusdt@kline_1s",
        "btcusdt@depth"
    ]
}
```
- ## 参数说明
|   字段   |   类型   | 是否必须 |        说明        |
|:------:|:------:|------|:----------------:|
| action | string | 是    | true/false（是否订阅） |
| params | array  | 是    |  订阅内容（可一次性填写多条）  |

- ## 返回格式
```
{"stream":"<streamName>","data":<rawPayload>}
```
- ## 返回示例
<details>
  <summary>查看返回参数示例</summary>
    <pre><code>{
    "stream": "btcusdt@depth",
    "data": {
        "e": "depthUpdate",
        "E": 1716793448107,
        "s": "BTCUSDT",
        "U": 47391989413,
        "u": 47391989449,
        "b": [
            [
                "68427.00000000",
                "2.55109000"
            ],
            [
                "68423.61000000",
                "0.00010000"
            ],
            [
                "68422.80000000",
                "0.00000000"
            ],
            [
                "68358.60000000",
                "0.00065000"
            ],
            [
                "68327.00000000",
                "0.02000000"
            ],
            [
                "67742.73000000",
                "0.00000000"
            ],
            [
                "62952.84000000",
                "0.00000000"
            ],
            [
                "61584.00000000",
                "0.00545000"
            ],
            [
                "54741.60000000",
                "0.00012000"
            ],
            [
                "34213.50000000",
                "0.00035000"
            ],
            [
                "33000.00000000",
                "12.57403000"
            ]
        ],
        "a": [
            [
                "68427.01000000",
                "5.21633000"
            ],
            [
                "68438.86000000",
                "0.04000000"
            ],
            [
                "68441.09000000",
                "0.00000000"
            ],
            [
                "68527.00000000",
                "0.00000000"
            ],
            [
                "68761.66000000",
                "0.00000000"
            ]
        ]
    }
}</code></pre>
</details>

- ## 错误码
| 错误信息                                                                                                                                                                        | 描述                                      |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|
| {"code": 0, "msg": "Unknown property"}	                                                                                                                                     | `SET_PROPERTY` 或 `GET_PROPERTY`中应用的参数无效 |
| {"code": 1, "msg": "Invalid value type: expected Boolean", "id": '%s'}		                                                                                                    | 仅接受`true`或`false`                       |
| {"code": 2, "msg": "Invalid value type: expected String", "id": '%s'}		                                                                                                     | 提供的属性名无效                                |
| {"code": 2, "msg": "Invalid request: request ID must be an unsigned integer"}		                                                                                             | 参数`id`未提供或`id`值是无效类型                    |
| {"code": 2, "msg": "Invalid request: unknown variant %s, expected one of SUBSCRIBE,<br/>UNSUBSCRIBE, LIST_SUBSCRIPTIONS, SET_PROPERTY, GET_PROPERTY at line 1 column 28"}		 | 错字提醒，或提供的值不是预期类型                        |
| {"code": 2, "msg": "Invalid request: too many parameters"}		                                                                                                                | 数据中提供了不必要参数                             |
| {"code": 2, "msg": "Invalid request: property name must be a string"}                                                                                                       | 未提供属性名                                  |
| {"code": 2, "msg": "Invalid request: missing field method at line 1 column 73"}                                                                                             | 数据未提供`method`                           |   
| {"code":3,"msg":"Invalid JSON: expected value at line %s column %s"}                                                                                                        | JSON 语法有误.                              |
------------------------------------------------------------


- ## 可选 params
  * ### 逐笔交易
      **Stream名称：** `<symbol>@trade`  
      逐笔交易推送每一笔成交的信息。**成交**（或者说交易）的定义是仅有一个吃单者与一个挂单者相互交易  
      **更新速度：** 实时  
      **payload：**  
      ```
      {
          "e": "trade",     // 事件类型
          "E": 1672515782136,   // 事件时间
          "s": "BNBBTC",    // 交易对
          "t": 12345,       // 交易ID
          "p": "0.001",     // 成交价格
          "q": "100",       // 成交数量
          "b": 88,          // 买方的订单ID
          "a": 50,          // 卖方的订单ID
          "T": 1672515782136,   // 成交时间
          "m": true,        // 买方是否是做市方。如true，则此次成交是一个主动卖出单，否则是一个主动买入单。
          "M": true         // 请忽略该字段
      }
      ```
  * ### K线 Stream
      K线 Stream 逐秒推送所请求的K线种类(最新一根K线)的更新。  
      **Stream名称：** `<symbol>@kline_<interval>`  
      **更新速度：** `1s`1000ms，其他间隔2000ms  
      **K线图间隔参数：** 1s 1m 3m 5m 15m 30m 1h 2h 4h 6h 8h 12h 1d 3d 1w 1M  
      **payload：**  
      ```
      {
          "e": "kline",     // 事件类型
          "E": 1672515782136,   // 事件时间
          "s": "BNBBTC",    // 交易对
          "k": {
              "t": 123400000, // 这根K线的起始时间
              "T": 123460000, // 这根K线的结束时间
              "s": "BNBBTC",  // 交易对
              "i": "1m",      // K线间隔
              "f": 100,       // 这根K线期间第一笔成交ID
              "L": 200,       // 这根K线期间末一笔成交ID
              "o": "0.0010",  // 这根K线期间第一笔成交价
              "c": "0.0020",  // 这根K线期间末一笔成交价
              "h": "0.0025",  // 这根K线期间最高成交价
              "l": "0.0015",  // 这根K线期间最低成交价
              "v": "1000",    // 这根K线期间成交量
              "n": 100,       // 这根K线期间成交笔数
              "x": false,     // 这根K线是否完结(是否已经开始下一根K线)
              "q": "1.0000",  // 这根K线期间成交额
              "V": "500",     // 主动买入的成交量
              "Q": "0.500",   // 主动买入的成交额
              "B": "123456"   // 忽略此参数
          }
      }
    ```
  * ### 按 Symbol 的精简Tricker
    按 Symbol 刷新的最近24小时精简 ticker 信息  
    **Stream 名称:** `<symbol>@miniTicker`  
    **更新速度：** 实时  
    **payload:**  
    ```
    {
        "e": "24hrMiniTicker",  // 事件类型
        "E": 1672515782136,         // 事件时间
        "s": "BNBBTC",          // 交易对
        "c": "0.0025",          // 最新成交价格
        "o": "0.0010",          // 24小时前开始第一笔成交价格
        "h": "0.0025",          // 24小时内最高成交价
        "l": "0.0010",          // 24小时内最低成交价
        "v": "10000",           // 成交量
        "q": "18"               // 成交额
    }
    ```
  * ### 全市场所有Symbol的精简Tricker
    同上，只是推送所有交易对，需要注意的是，只有更新的 ticker 才会推送  
    **Stream 名称:** `!miniTicker@arr`  
    **更新速度：** 1000ms  
    **payload:**  
    ```
    [
        {
            // 数组每一个元素对应一个交易对，内容与 \<symbol\>@miniTicker相同
        }
    ]
    ```
  * ### 按 Symbol 的完整Tricker
    每秒推送单个交易对的过去24小时滚动窗口标签统计信息  
    **Stream 名称:** `<symbol>@ticker`  
    **更新速度：** 1000ms  
    **payload：**  
    ```
    {
        "e": "24hrTicker", // 事件类型
        "E": 1672515782136, // 事件时间
        "s": "BNBBTC", // 交易对
        "p": "0.0015", // 24小时价格变化
        "P": "250.00", // 24小时价格变化(百分比)
        "w": "0.0018", // 平均价格
        "x": "0.0009", // 整整24小时之前，向前数的最后一次成交价格
        "c": "0.0025", // 最新成交价格
        "Q": "10", // 最新成交交易的成交量
        "b": "0.0024", // 目前最高买单价
        "B": "10", // 目前最高买单价的挂单量
        "a": "0.0026", // 目前最低卖单价
        "A": "100", // 目前最低卖单价的挂单量
        "o": "0.0010", // 整整24小时前，向后数的第一次成交价格
        "h": "0.0025", // 24小时内最高成交价
        "l": "0.0010", // 24小时内最低成交价
        "v": "10000", // 24小时内成交量
        "q": "18", // 24小时内成交额
        "O": 0, // 统计开始时间
        "C": 86400000, // 统计结束时间
        "F": 0, // 24小时内第一笔成交交易ID
        "L": 18150, // 24小时内最后一笔成交交易ID
        "n": 18151 // 24小时内成交数
    }
    ```
  * ### 全市场所有交易对的完整Ticker
    推送全市场所有交易对刷新的24小时完整 tricker 信息，需要注意的是，没有更新的 ticker 不会推送   
    **Stream 名称:** `!ticker@arr`  
    **更新速度：** 1000ms  
    **payload:**
    ```
    [
        {
            // Same as <symbol>@ticker payload
        }
    ]
    ```
  * ### 按symbol的滚动窗口统计
    单个symbol的滚动窗口统计，支持多个时间窗口  
    **Stream 名称:** `<symbol>@ticker_<window_size>`
    **Window Sizes:** 1h, 4h, 1d
    **更新速度：** 1000ms
    **payload:**
    ```
    {
        "e": "1hTicker", // Event type
        "E": 1672515782136, // Event time
        "s": "BNBBTC", // 交易对
        "p": "0.0015", // Price change
        "P": "250.00", // 时间窗口内的价格涨跌
        "o": "0.0010", // Open price
        "h": "0.0025", // High price
        "l": "0.0010", // Low price
        "c": "0.0025", // 最新价格
        "w": "0.0018", // Weighted average price
        "v": "10000", // Total traded base asset volume
        "q": "18", // Total traded quote asset volume
        "O": 0, // Statistics open time
        "C": 86400000, // Statistics close time
        "F": 0, // First trade ID
        "L": 18150, // Last trade Id
        "n": 18151 // 时间窗口内的总交易量
    }
    ```
    

    
        